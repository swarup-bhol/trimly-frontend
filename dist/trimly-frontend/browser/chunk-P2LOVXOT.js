import{h as H}from"./chunk-JAUZOHJ2.js";import{$ as n,A as o,Ga as j,H as S,Ha as U,Ia as W,J as x,K as w,L as N,M as A,N as R,P as b,Q as L,R as f,S as E,T as e,U as i,V as _,W as F,X as g,Y as h,Z as m,_ as D,aa as d,ba as c,ca as k,ia as $,ja as C,ka as O,la as I,ma as T,na as B,o as V,q as P,u as v,v as u,va as z,wa as M,xa as G}from"./chunk-EMWRS4DM.js";var y=(a,l)=>l.id,J=(a,l)=>l[0],K=()=>["all","ACTIVE","PENDING","DISABLED"],Y=()=>["all","All"],q=()=>["PENDING","Pending"],Q=()=>["CONFIRMED","Confirmed"],X=()=>["COMPLETED","Completed"],Z=()=>["CANCELLED","Cancelled"],tt=()=>["REJECTED","Rejected"],et=(a,l,t,r,s,p)=>[a,l,t,r,s,p];function it(a,l){if(a&1&&(e(0,"span",18),n(1),i()),a&2){let t=m().$implicit;o(),d(t.badge)}}function nt(a,l){if(a&1){let t=g();e(0,"button",17),h("click",function(){let s=v(t).$implicit,p=m();return u(p.tab.set(s.id))}),n(1),x(2,it,2,1,"span",18),i()}if(a&2){let t=l.$implicit,r=m();A("btn-amber",r.tab()===t.id)("btn-ghost",r.tab()!==t.id),o(),k(" ",t.icon," ",t.label," "),o(),b(2,t.badge&&t.badge>0?2:-1)}}function at(a,l){a&1&&(e(0,"div",16),_(1,"div",19),e(2,"span"),n(3,"Loading platform data..."),i()())}function ot(a,l){a&1&&F(0)}function lt(a,l){if(a&1&&x(0,ot,1,0,"ng-container",20),a&2){m(2);let t=D(22);w("ngTemplateOutlet",t)}}function rt(a,l){a&1&&F(0)}function mt(a,l){if(a&1&&x(0,rt,1,0,"ng-container",20),a&2){m(2);let t=D(24);w("ngTemplateOutlet",t)}}function dt(a,l){a&1&&F(0)}function st(a,l){if(a&1&&x(0,dt,1,0,"ng-container",20),a&2){m(2);let t=D(26);w("ngTemplateOutlet",t)}}function pt(a,l){a&1&&F(0)}function ct(a,l){if(a&1&&x(0,pt,1,0,"ng-container",20),a&2){m(2);let t=D(28);w("ngTemplateOutlet",t)}}function xt(a,l){if(a&1&&x(0,lt,1,1)(1,mt,1,1)(2,st,1,1)(3,ct,1,1),a&2){let t,r=m();b(0,(t=r.tab())==="overview"?0:t==="shops"?1:t==="bookings"?2:t==="revenue"?3:-1)}}function _t(a,l){if(a&1){let t=g();e(0,"div",48)(1,"div",50),n(2),i(),e(3,"div",51)(4,"div",52),n(5),i(),e(6,"div",53),n(7),i()(),e(8,"button",54),h("click",function(){let s=v(t).$implicit,p=m(3);return u(p.approveShop(s.id))}),n(9,"Approve"),i()()}if(a&2){let t=l.$implicit;o(2),d(t.emoji||"\u2702\uFE0F"),o(3),d(t.shopName),o(2),k("",t.location," \xB7 ",t.ownerName,"")}}function vt(a,l){a&1&&(e(0,"div",49)(1,"div",55),n(2,"\u2705"),i(),e(3,"div",56),n(4,"No pending shops"),i()())}function ut(a,l){if(a&1){let t=g();e(0,"div",27)(1,"div",28),_(2,"div",29),e(3,"div",30),n(4,"\u{1F3EA}"),i(),e(5,"div",31),n(6),i(),e(7,"div",32),n(8,"Total Shops"),i(),e(9,"div",33),n(10),i()(),e(11,"div",28),_(12,"div",29),e(13,"div",30),n(14,"\u23F3"),i(),e(15,"div",31),n(16),i(),e(17,"div",32),n(18,"Pending Approval"),i(),e(19,"div",34),n(20,"Needs review"),i()(),e(21,"div",28),_(22,"div",35),e(23,"div",30),n(24,"\u{1F4CB}"),i(),e(25,"div",36),n(26),i(),e(27,"div",32),n(28,"Total Bookings"),i(),e(29,"div",37),n(30),i()(),e(31,"div",28),_(32,"div",38),e(33,"div",30),n(34,"\u{1F464}"),i(),e(35,"div",39),n(36),i(),e(37,"div",32),n(38,"Customers"),i(),e(39,"div",40),n(40,"Registered"),i()()(),e(41,"div",41)(42,"div",42)(43,"div",43)(44,"div",44),n(45,"Platform Revenue"),i()(),e(46,"div",45),n(47),i(),e(48,"div",46),n(49),i()(),e(50,"div",42)(51,"div",43)(52,"div",44),n(53,"Pending Shops"),i(),e(54,"button",47),h("click",function(){v(t);let s=m(2);return u(s.tab.set("shops"))}),n(55,"Review All \u2192"),i()(),f(56,_t,10,4,"div",48,y),x(58,vt,5,0,"div",49),i()()}if(a&2){let t=m(2);o(6),d(t.stats().totalShops),o(4),c("",t.stats().activeShops," active"),o(6),d(t.stats().pendingShops),o(10),d(t.stats().totalBookings),o(4),c("",t.stats().completedBookings," completed"),o(6),d(t.stats().totalCustomers),o(11),c("\u20B9",t.stats().platformRevenue.toLocaleString("en-IN"),""),o(2),c("10% commission from \u20B9",t.stats().totalRevenue.toLocaleString("en-IN")," gross"),o(7),E(t.stats().recentShops.slice(0,3)),o(2),b(58,t.stats().recentShops.length===0?58:-1)}}function bt(a,l){if(a&1&&(e(0,"div",21)(1,"div",22)(2,"div",23),n(3,"Admin \xB7 "),e(4,"span",24),n(5,"Overview"),i()(),e(6,"div",25),n(7,"PLATFORM OVERVIEW"),i(),e(8,"div",26),n(9,"Real-time platform performance"),i()(),x(10,ut,59,9),i()),a&2){let t=m();o(10),b(10,t.stats()?10:-1)}}function gt(a,l){if(a&1){let t=g();e(0,"button",17),h("click",function(){let s=v(t).$implicit,p=m(2);return u(p.shopFilter.set(s))}),n(1),i()}if(a&2){let t=l.$implicit,r=m(2);A("btn-amber",r.shopFilter()===t)("btn-outline",r.shopFilter()!==t),o(),d(t==="all"?"All":t)}}function ht(a,l){if(a&1){let t=g();e(0,"button",54),h("click",function(){v(t);let s=m().$implicit,p=m(2);return u(p.approveShop(s.id))}),n(1,"Approve"),i()}}function St(a,l){if(a&1){let t=g();e(0,"button",71),h("click",function(){v(t);let s=m().$implicit,p=m(2);return u(p.disableShop(s.id))}),n(1,"Disable"),i()}}function ft(a,l){if(a&1){let t=g();e(0,"button",72),h("click",function(){v(t);let s=m().$implicit,p=m(2);return u(p.enableShop(s.id))}),n(1,"Enable"),i()}}function Et(a,l){if(a&1&&(e(0,"tr")(1,"td")(2,"div",61),n(3),i()(),e(4,"td",62),n(5),i(),e(6,"td",63),n(7),i(),e(8,"td")(9,"span",64),n(10),i()(),e(11,"td")(12,"span",64),n(13),i()(),e(14,"td",65),n(15),I(16,"number"),i(),e(17,"td",66),n(18),i(),e(19,"td")(20,"div",67),x(21,ht,2,0,"button",68)(22,St,2,0,"button",69)(23,ft,2,0,"button",70),i()()()),a&2){let t=l.$implicit;o(3),k("",t.emoji||"\u2702\uFE0F"," ",t.shopName,""),o(2),d(t.ownerName),o(2),d(t.location),o(2),A("by",t.plan==="pro")("bm",t.plan!=="pro"),o(),d(t.plan),o(2),A("bg",t.status==="ACTIVE")("by",t.status==="PENDING")("br",t.status==="DISABLED"),o(),d(t.status),o(2),d(t.rating?T(16,21,t.rating,"1.1-1")+"\u2605":"\u2014"),o(3),d(t.totalBookings),o(3),b(21,t.status==="PENDING"?21:-1),o(),b(22,t.status==="ACTIVE"?22:-1),o(),b(23,t.status==="DISABLED"?23:-1)}}function Ct(a,l){if(a&1&&(e(0,"div",21)(1,"div",22)(2,"div",23),n(3,"Admin \xB7 "),e(4,"span",24),n(5,"All Shops"),i()(),e(6,"div",25),n(7,"ALL SHOPS"),i(),e(8,"div",26),n(9,"Manage all barber shops on the platform"),i()(),e(10,"div",57),f(11,gt,2,5,"button",58,L),i(),e(13,"div",59)(14,"table",60)(15,"thead")(16,"tr")(17,"th"),n(18,"Shop"),i(),e(19,"th"),n(20,"Owner"),i(),e(21,"th"),n(22,"Location"),i(),e(23,"th"),n(24,"Plan"),i(),e(25,"th"),n(26,"Status"),i(),e(27,"th"),n(28,"Rating"),i(),e(29,"th"),n(30,"Bookings"),i(),e(31,"th"),n(32,"Actions"),i()()(),e(33,"tbody"),f(34,Et,24,24,"tr",null,y),i()()()()),a&2){let t=m();o(11),E(C(0,K)),o(23),E(t.filteredShops())}}function At(a,l){if(a&1){let t=g();e(0,"button",17),h("click",function(){let s=v(t).$implicit,p=m(2);return u(p.bookingFilter.set(s[0]))}),n(1),i()}if(a&2){let t=l.$implicit,r=m(2);A("btn-amber",r.bookingFilter()===t[0])("btn-outline",r.bookingFilter()!==t[0]),o(),d(t[1])}}function kt(a,l){if(a&1&&(e(0,"tr")(1,"td")(2,"div",61),n(3),i(),e(4,"div",77),n(5),i()(),e(6,"td",62),n(7),i(),e(8,"td",78),n(9),i(),e(10,"td",62),n(11),i(),e(12,"td",66),n(13),i(),e(14,"td")(15,"span",79),n(16),i()(),e(17,"td",80),n(18),I(19,"number"),i(),e(20,"td")(21,"span",64),n(22),i()()()),a&2){let t=l.$implicit,r=m(2);o(3),d(t.customerName),o(2),d(t.customerPhone),o(2),d(t.shopName),o(2),d(t.servicesLabel),o(2),k("",t.bookingDate," \xB7 ",t.slot,""),o(2),c("",t.duration,"m"),o(3),c("\u20B9",t.amount,""),o(2),c("\u20B9",T(19,12,t.amount*.1,"1.0-0"),""),o(3),R(r.statusClass(t.status)),o(),d(t.status)}}function It(a,l){if(a&1&&(e(0,"div",21)(1,"div",22)(2,"div",23),n(3,"Admin \xB7 "),e(4,"span",24),n(5,"Bookings"),i()(),e(6,"div",73)(7,"div")(8,"div",25),n(9,"ALL BOOKINGS"),i(),e(10,"div",26),n(11,"Every transaction across the platform"),i()(),e(12,"div",74)(13,"div",75),n(14),I(15,"number"),i(),e(16,"div",76),n(17),i()()()(),e(18,"div",57),f(19,At,2,5,"button",58,J),i(),e(21,"div",59)(22,"table",60)(23,"thead")(24,"tr")(25,"th"),n(26,"Customer"),i(),e(27,"th"),n(28,"Shop"),i(),e(29,"th"),n(30,"Services"),i(),e(31,"th"),n(32,"Date \xB7 Slot"),i(),e(33,"th"),n(34,"Duration"),i(),e(35,"th"),n(36,"Amount"),i(),e(37,"th"),n(38,"Commission"),i(),e(39,"th"),n(40,"Status"),i()()(),e(41,"tbody"),f(42,kt,23,15,"tr",null,y),i()()()()),a&2){let t=m();o(14),c("\u20B9",T(15,2,t.filteredCommission(),"1.0-0"),""),o(3),c("Commission (",t.bookingFilter(),")"),o(2),E(O(11,et,C(5,Y),C(6,q),C(7,Q),C(8,X),C(9,Z),C(10,tt))),o(23),E(t.filteredBookings())}}function Tt(a,l){if(a&1&&(e(0,"div",84)(1,"div",85)(2,"div",86),n(3),e(4,"span",64),n(5),i()(),e(6,"div",74)(7,"span",87),n(8),I(9,"number"),i(),e(10,"span",88),n(11),I(12,"number"),i()()(),e(13,"div",89),_(14,"div",90),i(),e(15,"div",91),n(16),i()()),a&2){let t=l.$implicit;o(3),k("",t.emoji||"\u2702\uFE0F"," ",t.shopName," "),o(),A("by",t.plan==="pro")("bm",t.plan!=="pro"),o(),d(t.plan),o(3),c("\u20B9",T(9,13,t.monthlyRev*t.commissionPct/100,"1.0-0"),""),o(3),c("from \u20B9",T(12,16,t.monthlyRev,"1.0-0"),""),o(3),N("width",(t.monthlyRev>0?t.commissionPct:0)+"%"),o(2),k("",t.commissionPct,"% commission + \u20B9",t.subscriptionFee,"/mo subscription")}}function wt(a,l){if(a&1&&(e(0,"div",27)(1,"div",28),_(2,"div",29),e(3,"div",30),n(4,"\u{1F4B3}"),i(),e(5,"div",31),n(6),i(),e(7,"div",32),n(8,"Booking Commission"),i(),e(9,"div",33),n(10,"10% per booking"),i()(),e(11,"div",28),_(12,"div",35),e(13,"div",30),n(14,"\u{1F3C6}"),i(),e(15,"div",36),n(16),i(),e(17,"div",32),n(18,"Gross Revenue"),i(),e(19,"div",37),n(20,"All bookings"),i()(),e(21,"div",28),_(22,"div",38),e(23,"div",30),n(24,"\u{1F4C8}"),i(),e(25,"div",39),n(26),i(),e(27,"div",32),n(28,"Paying Shops"),i(),e(29,"div",40),n(30,"Active"),i()(),e(31,"div",28),_(32,"div",81),e(33,"div",30),n(34,"\u{1F4CB}"),i(),e(35,"div",82),n(36),i(),e(37,"div",32),n(38,"Completed Bookings"),i(),e(39,"div",40),n(40,"Revenue earned"),i()()(),e(41,"div",83)(42,"div",43)(43,"div",44),n(44,"Per-Shop Breakdown"),i()(),f(45,Tt,17,19,"div",84,y),i()),a&2){let t=m(2);o(6),c("\u20B9",t.stats().platformRevenue.toLocaleString("en-IN"),""),o(10),c("\u20B9",t.stats().totalRevenue.toLocaleString("en-IN"),""),o(10),d(t.stats().activeShops),o(10),d(t.stats().completedBookings),o(9),E(t.shops())}}function Ft(a,l){if(a&1&&(e(0,"div",21)(1,"div",22)(2,"div",23),n(3,"Admin \xB7 "),e(4,"span",24),n(5,"Revenue"),i()(),e(6,"div",25),n(7,"REVENUE"),i()(),x(8,wt,47,4),i()),a&2){let t=m();o(8),b(8,t.stats()?8:-1)}}var zt=(()=>{class a{constructor(){this.api=V(U),this.authSvc=V(W),this.toast=V(j),this.tab=S("overview"),this.loading=S(!0),this.stats=S(null),this.shops=S([]),this.bookings=S([]),this.shopFilter=S("all"),this.bookingFilter=S("all")}get navItems(){return[{id:"overview",icon:"\u{1F4CA}",label:"Overview",badge:0},{id:"shops",icon:"\u{1F3EA}",label:"All Shops",badge:this.stats()?.pendingShops??0},{id:"bookings",icon:"\u{1F4CB}",label:"Bookings",badge:0},{id:"revenue",icon:"\u{1F4B0}",label:"Revenue",badge:0}]}filteredShops(){let t=this.shopFilter();return t==="all"?this.shops():this.shops().filter(r=>r.status===t)}filteredBookings(){let t=this.bookingFilter();return t==="all"?this.bookings():this.bookings().filter(r=>r.status===t)}filteredCommission(){return this.filteredBookings().reduce((t,r)=>t+r.amount*.1,0)}ngOnInit(){this.loadData()}loadData(){this.loading.set(!0),this.api.get("/admin/stats").subscribe({next:t=>{this.stats.set(t),this.loading.set(!1)}}),this.api.get("/shops").subscribe({next:t=>this.shops.set(t)}),this.api.get("/bookings").subscribe({next:t=>this.bookings.set(t)})}approveShop(t){this.api.patchWithParams(`/shops/${t}/status`,{status:"ACTIVE"}).subscribe({next:()=>{this.toast.show("Shop Approved \u2713","Barber can now start accepting bookings.","ok"),this.loadData()},error:()=>this.toast.show("Error","Failed to approve shop","err")})}disableShop(t){this.api.patchWithParams(`/shops/${t}/status`,{status:"DISABLED"}).subscribe({next:()=>{this.toast.show("Shop Disabled","Barber cannot login until re-enabled.","warn"),this.loadData()},error:()=>this.toast.show("Error","Failed to disable shop","err")})}enableShop(t){this.api.patchWithParams(`/shops/${t}/status`,{status:"ACTIVE"}).subscribe({next:()=>{this.toast.show("Shop Re-enabled","Barber can now login again.","ok"),this.loadData()},error:()=>this.toast.show("Error","Failed to enable shop","err")})}statusClass(t){return t==="ACTIVE"?"bg":t==="PENDING"?"by":t==="CONFIRMED"?"bb":t==="COMPLETED"?"bm":"br"}logout(){this.authSvc.logout()}static{this.\u0275fac=function(r){return new(r||a)}}static{this.\u0275cmp=P({type:a,selectors:[["app-admin"]],standalone:!0,features:[$],decls:29,vars:1,consts:[["overviewTpl",""],["shopsTpl",""],["bookingsTpl",""],["revenueTpl",""],[2,"display","flex","flex-direction","column","min-height","100vh"],[1,"topbar"],[1,"topbar-brand"],[2,"display","flex","gap","6px","flex-wrap","wrap"],[1,"btn","btn-sm",3,"btn-amber","btn-ghost"],[1,"topbar-right"],[1,"user-pill"],[1,"up-av"],[1,"up-name"],[1,"up-role"],[1,"btn","btn-ghost","btn-sm",3,"click"],[1,"main-content"],[1,"loading-overlay"],[1,"btn","btn-sm",3,"click"],[2,"background","var(--crimson)","color","#fff","font-size","10px","padding","1px 6px","border-radius","10px","margin-left","4px"],[1,"spinner"],[4,"ngTemplateOutlet"],[1,"page"],[1,"ph"],[1,"ph-bc"],[1,"ph-bc-cur"],[1,"ph-title"],[1,"ph-sub"],[1,"sg"],[1,"sc"],[1,"sc-accent",2,"background","linear-gradient(90deg,var(--amber),transparent)"],[1,"sc-icon"],[1,"sc-val",2,"color","var(--amber)"],[1,"sc-label"],[1,"sc-chip","chip-y"],[1,"sc-chip","chip-r"],[1,"sc-accent",2,"background","linear-gradient(90deg,var(--emerald),transparent)"],[1,"sc-val",2,"color","var(--emerald)"],[1,"sc-chip","chip-g"],[1,"sc-accent",2,"background","linear-gradient(90deg,var(--sky),transparent)"],[1,"sc-val",2,"color","var(--sky)"],[1,"sc-chip","chip-b"],[1,"g2",2,"margin-top","20px"],[1,"card"],[1,"ch"],[1,"ct"],[2,"font-family","'Unbounded',sans-serif","font-size","36px","font-weight","900","color","var(--amber)"],[2,"font-size","12px","color","var(--text3)","margin-top","4px"],[1,"btn","btn-sm","btn-amber",3,"click"],[2,"display","flex","align-items","center","gap","12px","padding","12px 0","border-bottom","1px solid var(--border)"],[1,"empty"],[2,"font-size","24px"],[2,"flex","1"],[2,"font-weight","700","font-size","13px"],[2,"font-size","11px","color","var(--text3)"],[1,"btn","btn-emerald","btn-sm",3,"click"],[1,"ei"],[1,"et"],[2,"display","flex","gap","6px","margin-bottom","18px","flex-wrap","wrap"],[1,"btn","btn-sm",3,"btn-amber","btn-outline"],[1,"tw"],[1,"tb"],[1,"tn"],[2,"color","var(--text2)","font-size","12px"],[2,"color","var(--text3)","font-size","12px"],[1,"badge"],[2,"color","var(--amber)"],[2,"color","var(--text2)"],[2,"display","flex","gap","6px"],[1,"btn","btn-emerald","btn-sm"],[1,"btn","btn-crimson","btn-sm"],[1,"btn","btn-sky","btn-sm"],[1,"btn","btn-crimson","btn-sm",3,"click"],[1,"btn","btn-sky","btn-sm",3,"click"],[1,"ph-row"],[2,"text-align","right"],[2,"font-family","'Unbounded',sans-serif","font-size","32px","font-weight","900","color","var(--amber)"],[2,"font-size","12px","color","var(--text2)"],[1,"ts"],[2,"color","var(--text2)","font-size","12px","max-width","160px"],[1,"ta"],[2,"font-family","'Unbounded',sans-serif","font-size","16px","color","var(--amber)"],[1,"sc-accent",2,"background","linear-gradient(90deg,var(--violet),transparent)"],[1,"sc-val",2,"color","var(--violet)"],[1,"card",2,"margin-top","20px"],[2,"padding","16px 0","border-bottom","1px solid var(--border)"],[2,"display","flex","justify-content","space-between","margin-bottom","8px"],[2,"font-weight","600"],[2,"font-family","'Unbounded',sans-serif","font-size","20px","color","var(--amber)"],[2,"font-size","11px","color","var(--text3)","margin-left","8px"],[2,"height","6px","border-radius","3px","overflow","hidden","background","rgba(255,255,255,0.05)"],[2,"height","100%","background","var(--amber)","border-radius","3px"],[2,"font-size","11px","color","var(--text3)","margin-top","5px"]],template:function(r,s){if(r&1){let p=g();e(0,"div",4)(1,"header",5)(2,"div",6),n(3,"TRIMLY ADMIN"),i(),e(4,"div",7),f(5,nt,3,7,"button",8,y),i(),e(7,"div",9)(8,"div",10)(9,"div",11),n(10,"A"),i(),e(11,"div")(12,"div",12),n(13,"Admin"),i(),e(14,"div",13),n(15,"Platform"),i()()(),e(16,"button",14),h("click",function(){return v(p),u(s.logout())}),n(17,"Logout"),i()()(),e(18,"div",15),x(19,at,4,0,"div",16)(20,xt,4,1),i()(),x(21,bt,11,1,"ng-template",null,0,B)(23,Ct,36,1,"ng-template",null,1,B)(25,It,44,18,"ng-template",null,2,B)(27,Ft,9,1,"ng-template",null,3,B)}r&2&&(o(5),E(s.navItems),o(14),b(19,s.loading()?19:20))},dependencies:[G,z,M,H],encapsulation:2})}}return a})();export{zt as AdminComponent};
