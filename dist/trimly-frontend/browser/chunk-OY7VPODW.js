import{a as ne,b as oe,c as le,d as ae}from"./chunk-NOJ7QKFX.js";import{a as K,b as Q,c as X,d as Y,h as Z,i as ee,k as te}from"./chunk-BSUZVFBV.js";import{$ as d,Aa as H,B as l,I as E,K as v,M as A,N as M,O as I,P as O,Pa as J,Qa as ie,R as b,T as f,U as g,V as t,W as i,X as F,Y as V,Z as h,_ as x,da as D,ea as n,fa as p,ga as u,ha as G,ja as W,ka as j,la as z,na as L,p as T,pa as w,qa as k,r as $,ra as y,v as c,w as _,ya as U,za as q}from"./chunk-EIAEMANE.js";var re=(o,m)=>m.tab,B=(o,m)=>m.id,me=(o,m)=>m.val;function se(o,m){if(o&1&&(t(0,"span",15),n(1),i()),o&2){let e=d(2);l(),p(e.pendingShops())}}function de(o,m){if(o&1){let e=h();t(0,"button",10),x("click",function(){let a=c(e).$implicit,s=d();return _(s.tab.set(a.tab))}),t(1,"span",14),n(2),i(),n(3),v(4,se,2,1,"span",15),i()}if(o&2){let e=m.$implicit,r=d();I("on",r.tab()===e.tab),l(2),p(e.icon),l(),u("",e.label," "),l(),b(4,e.tab==="shops"&&r.pendingShops()>0?4:-1)}}function pe(o,m){o&1&&V(0)}function ce(o,m){if(o&1&&v(0,pe,1,0,"ng-container",16),o&2){d();let e=D(20);A("ngTemplateOutlet",e)}}function _e(o,m){o&1&&V(0)}function xe(o,m){if(o&1&&v(0,_e,1,0,"ng-container",16),o&2){d();let e=D(22);A("ngTemplateOutlet",e)}}function ue(o,m){o&1&&V(0)}function ve(o,m){if(o&1&&v(0,ue,1,0,"ng-container",16),o&2){d();let e=D(24);A("ngTemplateOutlet",e)}}function be(o,m){o&1&&V(0)}function he(o,m){if(o&1&&v(0,be,1,0,"ng-container",16),o&2){d();let e=D(26);A("ngTemplateOutlet",e)}}function Ce(o,m){if(o&1&&(t(0,"span",18),n(1),i()),o&2){let e=d(2);l(),p(e.pendingShops())}}function Se(o,m){if(o&1){let e=h();t(0,"button",17),x("click",function(){let a=c(e).$implicit,s=d();return _(s.tab.set(a.tab))}),v(1,Ce,2,1,"span",18),t(2,"span",19),n(3),i(),n(4),i()}if(o&2){let e=m.$implicit,r=d();I("on",r.tab()===e.tab),l(),b(1,e.tab==="shops"&&r.pendingShops()>0?1:-1),l(2),p(e.icon),l(),u("",e.label," ")}}function fe(o,m){o&1&&(t(0,"div",30),n(1,"Needs action"),i())}function ge(o,m){if(o&1){let e=h();t(0,"div",37)(1,"div",38)(2,"div",39),n(3),i(),t(4,"div")(5,"div",40),n(6),i(),t(7,"div",41),n(8),i()()(),t(9,"button",42),x("click",function(){let a=c(e).$implicit,s=d(3);return _(s.approve(a.id))}),n(10,"\u2713 Approve"),i()()}if(o&2){let e=m.$implicit;l(3),p(e.emoji||"\u2702\uFE0F"),l(3),p(e.shopName),l(2),G("",e.ownerName," \xB7 ",e.city,"")}}function Ee(o,m){if(o&1){let e=h();t(0,"div",33)(1,"div",34)(2,"div",35),n(3,"\u23F3 Shops Awaiting Approval"),i(),t(4,"button",36),x("click",function(){c(e);let a=d(2);return _(a.tab.set("shops"))}),n(5,"View all \u2192"),i()(),f(6,ge,11,4,"div",37,B),i()}if(o&2){let e=d(2);l(6),g(e.pendingShopsPreview())}}function we(o,m){if(o&1&&(t(0,"div",20)(1,"div",21)(2,"div",22),n(3,"Platform Overview \u{1F451}"),i(),t(4,"div",23),n(5),i()(),t(6,"div",24)(7,"div",25)(8,"div",26),n(9,"\u{1F3EA}"),i(),t(10,"div",27),n(11),i(),t(12,"div",28),n(13,"Total Shops"),i(),t(14,"div",29),n(15),i()(),t(16,"div",25)(17,"div",26),n(18,"\u23F3"),i(),t(19,"div",27),n(20),i(),t(21,"div",28),n(22,"Pending Approval"),i(),v(23,fe,2,0,"div",30),i(),t(24,"div",25)(25,"div",26),n(26,"\u{1F464}"),i(),t(27,"div",27),n(28),i(),t(29,"div",28),n(30,"Customers"),i()(),t(31,"div",25)(32,"div",26),n(33,"\u{1F4C5}"),i(),t(34,"div",27),n(35),i(),t(36,"div",28),n(37,"Total Bookings"),i()()(),t(38,"div",31)(39,"div",25)(40,"div",26),n(41,"\u{1F4B0}"),i(),t(42,"div",27),n(43),w(44,"number"),i(),t(45,"div",28),n(46,"Gross Revenue"),i(),t(47,"div",29),n(48,"Platform total"),i()(),t(49,"div",25)(50,"div",26),n(51,"\u{1F3E2}"),i(),t(52,"div",27),n(53),w(54,"number"),i(),t(55,"div",28),n(56,"Platform Commission"),i(),t(57,"div",32),n(58,"10% of completed"),i()()(),v(59,Ee,8,0,"div",33),i()),o&2){let e,r,a,s,S,P,R,N,C=d();l(5),u("",C.todayDate," \xB7 Admin Dashboard"),l(6),p(((e=C.stats())==null?null:e.totalShops)||0),l(4),u("",((r=C.stats())==null?null:r.activeShops)||0," active"),l(5),p(((a=C.stats())==null?null:a.pendingShops)||0),l(3),b(23,(((s=C.stats())==null?null:s.pendingShops)||0)>0?23:-1),l(5),p(((S=C.stats())==null?null:S.totalCustomers)||0),l(7),p(((P=C.stats())==null?null:P.totalBookings)||0),l(8),u("\u20B9",k(44,10,(R=C.stats())==null?null:R.totalRevenue,"1.0-0"),""),l(10),u("\u20B9",k(54,13,(N=C.stats())==null?null:N.totalCommission,"1.0-0"),""),l(6),b(59,C.pendingShops()>0?59:-1)}}function ke(o,m){if(o&1){let e=h();t(0,"button",49),x("click",function(){let a=c(e).$implicit,s=d(2);return _(s.shopFilter.set(a.val))}),n(1),i()}if(o&2){let e=m.$implicit,r=d(2);I("on",r.shopFilter()===e.val),l(),p(e.label)}}function Ae(o,m){if(o&1){let e=h();t(0,"button",42),x("click",function(){c(e);let a=d().$implicit,s=d(2);return _(s.approve(a.id))}),n(1,"\u2713 Approve"),i()}}function Te(o,m){if(o&1){let e=h();t(0,"button",61),x("click",function(){c(e);let a=d().$implicit,s=d(2);return _(s.disable(a.id))}),n(1,"Disable"),i()}}function Ie(o,m){if(o&1){let e=h();t(0,"button",42),x("click",function(){c(e);let a=d().$implicit,s=d(2);return _(s.enable(a.id))}),n(1,"Enable"),i()}}function Fe(o,m){if(o&1){let e=h();t(0,"tr")(1,"td")(2,"div",50)(3,"span",51),n(4),i(),t(5,"div")(6,"div",52),n(7),i(),t(8,"div",53),n(9),i()()()(),t(10,"td")(11,"div",52),n(12),i(),t(13,"div",53),n(14),i()(),t(15,"td"),n(16),i(),t(17,"td")(18,"span",54),n(19),i()(),t(20,"td"),F(21,"app-badge",55),i(),t(22,"td"),n(23),i(),t(24,"td",56),n(25),w(26,"number"),i(),t(27,"td")(28,"div",57),v(29,Ae,2,0,"button",58)(30,Te,2,0,"button",59)(31,Ie,2,0,"button",58),t(32,"button",60),x("click",function(){let a=c(e).$implicit,s=d(2);return _(s.openCommission(a))}),n(33,"% Fee"),i()()()()}if(o&2){let e=m.$implicit;l(4),p(e.emoji||"\u2702\uFE0F"),l(3),p(e.shopName),l(2),p(e.area),l(3),p(e.ownerName),l(2),p(e.ownerEmail),l(2),p(e.city),l(2),O(e.plan==="PRO"?"bv":"bm"),l(),p(e.plan),l(2),A("status",e.status),l(2),p(e.totalBookings||0),l(2),u("\u20B9",k(26,15,e.monthlyRevenue,"1.0-0"),""),l(4),b(29,e.status==="PENDING"?29:-1),l(),b(30,e.status==="ACTIVE"?30:-1),l(),b(31,e.status==="DISABLED"?31:-1)}}function Ve(o,m){if(o&1){let e=h();t(0,"div",62),x("click",function(){c(e);let a=d(2);return _(a.commissionShop.set(null))}),t(1,"div",63),x("click",function(a){return c(e),_(a.stopPropagation())}),t(2,"div",64)(3,"div",65),n(4,"Set Commission"),i(),t(5,"button",66),x("click",function(){c(e);let a=d(2);return _(a.commissionShop.set(null))}),n(6,"\xD7"),i()(),t(7,"div",67)(8,"div",68),n(9),i(),t(10,"div",69)(11,"label",70),n(12),i(),t(13,"input",71),z("ngModelChange",function(a){c(e);let s=d(2);return j(s.newCommission,a)||(s.newCommission=a),_(a)}),i()()(),t(14,"div",72)(15,"button",73),x("click",function(){c(e);let a=d(2);return _(a.commissionShop.set(null))}),n(16,"Cancel"),i(),t(17,"button",74),x("click",function(){c(e);let a=d(2);return _(a.saveCommission())}),n(18,"Save"),i()()()()}if(o&2){let e=d(2);l(9),p(e.commissionShop().shopName),l(3),u("Commission % (current: ",e.commissionShop().commissionPercent,"%)"),l(),W("ngModel",e.newCommission)}}function De(o,m){if(o&1&&(t(0,"div",20)(1,"div",21)(2,"div",43)(3,"div")(4,"div",22),n(5,"All Shops"),i(),t(6,"div",23),n(7),i()()()(),t(8,"div",44),f(9,ke,2,3,"button",45,me),i(),t(11,"div",46)(12,"table",47)(13,"thead")(14,"tr")(15,"th"),n(16,"Shop"),i(),t(17,"th"),n(18,"Owner"),i(),t(19,"th"),n(20,"City"),i(),t(21,"th"),n(22,"Plan"),i(),t(23,"th"),n(24,"Status"),i(),t(25,"th"),n(26,"Bookings"),i(),t(27,"th"),n(28,"Revenue"),i(),t(29,"th"),n(30,"Actions"),i()()(),t(31,"tbody"),f(32,Fe,34,18,"tr",null,B),i()()()(),v(34,Ve,19,3,"div",48)),o&2){let e=d();l(7),u("",e.shops().length," shops on platform"),l(2),g(e.shopFilters),l(23),g(e.filteredShops()),l(2),b(34,e.commissionShop()?34:-1)}}function ye(o,m){if(o&1){let e=h();t(0,"button",49),x("click",function(){let a=c(e).$implicit,s=d(2);return _(s.bkFilter.set(a.val))}),n(1),i()}if(o&2){let e=m.$implicit,r=d(2);I("on",r.bkFilter()===e.val),l(),p(e.label)}}function Be(o,m){if(o&1&&(t(0,"tr")(1,"td")(2,"div",52),n(3),i(),t(4,"div",53),n(5),i()(),t(6,"td"),n(7),i(),t(8,"td"),n(9),i(),t(10,"td")(11,"div"),n(12),i(),t(13,"div",53),n(14),i()(),t(15,"td",56),n(16),i(),t(17,"td"),F(18,"app-badge",55),i()()),o&2){let e=m.$implicit;l(3),p(e.customerName),l(2),p(e.customerPhone),l(2),p(e.shopName),l(2),p(e.servicesSnapshot),l(3),p(e.bookingDate),l(2),p(e.slotTime),l(2),u("\u20B9",e.totalAmount,""),l(2),A("status",e.status)}}function Pe(o,m){if(o&1&&(t(0,"div",20)(1,"div",21)(2,"div",43)(3,"div")(4,"div",22),n(5,"All Bookings"),i(),t(6,"div",23),n(7),i()()()(),t(8,"div",44),f(9,ye,2,3,"button",45,me),i(),t(11,"div",46)(12,"table",47)(13,"thead")(14,"tr")(15,"th"),n(16,"Customer"),i(),t(17,"th"),n(18,"Shop"),i(),t(19,"th"),n(20,"Services"),i(),t(21,"th"),n(22,"Date & Time"),i(),t(23,"th"),n(24,"Amount"),i(),t(25,"th"),n(26,"Status"),i()()(),t(27,"tbody"),f(28,Be,19,8,"tr",null,B),i()()()()),o&2){let e=d();l(7),u("",e.bookings().length," total"),l(2),g(e.bkFilters),l(19),g(e.filteredBookings())}}function Re(o,m){if(o&1&&(t(0,"div",76)(1,"div",77)(2,"div")(3,"span",78),n(4),i(),t(5,"b",79),n(6),i(),t(7,"span",80),n(8),i()(),t(9,"div",81),n(10),w(11,"number"),i()(),t(12,"div",82),F(13,"div",83),i()()),o&2){let e=m.$implicit,r=d(2);l(4),p(e.emoji||"\u2702\uFE0F"),l(2),p(e.shopName),l(2),p(e.city),l(2),u("\u20B9",k(11,6,e.monthlyRevenue,"1.0-0"),""),l(3),M("width",r.revenueWidth(e.monthlyRevenue||0))}}function Ne(o,m){if(o&1&&(t(0,"div",20)(1,"div",21)(2,"div",22),n(3,"Revenue Analytics \u{1F4CA}"),i()(),t(4,"div",24)(5,"div",25)(6,"div",26),n(7,"\u{1F4B0}"),i(),t(8,"div",27),n(9),w(10,"number"),i(),t(11,"div",28),n(12,"Gross Revenue"),i(),t(13,"div",29),n(14,"All time"),i()(),t(15,"div",25)(16,"div",26),n(17,"\u{1F3E2}"),i(),t(18,"div",27),n(19),w(20,"number"),i(),t(21,"div",28),n(22,"Platform Earnings"),i(),t(23,"div",32),n(24,"10% commission"),i()(),t(25,"div",25)(26,"div",26),n(27,"\u2702\uFE0F"),i(),t(28,"div",27),n(29),w(30,"number"),i(),t(31,"div",28),n(32,"Barber Payouts"),i()(),t(33,"div",25)(34,"div",26),n(35,"\u{1F3C1}"),i(),t(36,"div",27),n(37),i(),t(38,"div",28),n(39,"Completed Bookings"),i()()(),t(40,"div",75)(41,"div",34)(42,"div",35),n(43,"Revenue by Shop"),i()(),f(44,Re,14,9,"div",76,B),i()()),o&2){let e,r,a,s,S=d();l(9),u("\u20B9",k(10,4,(e=S.stats())==null?null:e.totalRevenue,"1.0-0"),""),l(10),u("\u20B9",k(20,7,(r=S.stats())==null?null:r.totalCommission,"1.0-0"),""),l(10),u("\u20B9",k(30,10,(a=S.stats())==null?null:a.barberEarnings,"1.0-0"),""),l(8),p(((s=S.stats())==null?null:s.completedBookings)||0),l(7),g(S.shopsWithRevenue())}}var Qe=(()=>{class o{constructor(){this.auth=T(J),this.shopSvc=T(le),this.bookSvc=T(ne),this.toast=T(ie),this.tab=E("overview"),this.shops=E([]),this.bookings=E([]),this.stats=E(null),this.shopFilter=E(""),this.bkFilter=E(""),this.commissionShop=E(null),this.newCommission=10,this.nav=[{tab:"overview",icon:"\u{1F4CA}",label:"Overview"},{tab:"shops",icon:"\u{1F3EA}",label:"Shops"},{tab:"bookings",icon:"\u{1F4C5}",label:"Bookings"},{tab:"revenue",icon:"\u{1F4B0}",label:"Revenue"}],this.shopFilters=[{val:"",label:"All"},{val:"ACTIVE",label:"\u{1F7E2} Active"},{val:"PENDING",label:"\u23F3 Pending"},{val:"DISABLED",label:"\u26D4 Disabled"}],this.bkFilters=[{val:"",label:"All"},{val:"pending",label:"\u23F3 Pending"},{val:"confirmed",label:"\u2713 Confirmed"},{val:"completed",label:"\u{1F3C1} Completed"},{val:"cancelled",label:"Cancelled"}]}get todayDate(){return new Date().toLocaleDateString("en-IN",{weekday:"long",day:"numeric",month:"long",year:"numeric"})}pendingShops(){return this.shops().filter(e=>e.status==="PENDING").length}pendingShopsPreview(){return this.shops().filter(e=>e.status==="PENDING").slice(0,3)}filteredShops(){return this.shopFilter()?this.shops().filter(e=>e.status===this.shopFilter()):this.shops()}filteredBookings(){return this.bkFilter()?this.bookings().filter(e=>e.status===this.bkFilter()):this.bookings()}shopsWithRevenue(){return this.shops().filter(e=>(e.monthlyRevenue||0)>0).sort((e,r)=>(r.monthlyRevenue||0)-(e.monthlyRevenue||0))}maxRevenue(){return Math.max(...this.shops().map(e=>e.monthlyRevenue||0),1)}revenueWidth(e){return Math.round(e/this.maxRevenue()*100)+"%"}ngOnInit(){this.shopSvc.adminGetAllShops().subscribe({next:e=>this.shops.set(e.data||[])}),this.bookSvc.adminGetAllBookings().subscribe({next:e=>this.bookings.set(e.data||[])}),this.bookSvc.adminGetStats().subscribe({next:e=>this.stats.set(e.data)})}approve(e){this.shopSvc.adminApprove(e).subscribe({next:r=>{this.shops.update(a=>a.map(s=>s.id===e?r.data:s)),this.toast.ok("Shop approved \u2705","Barber notified via WhatsApp")}})}disable(e){this.shopSvc.adminDisable(e).subscribe({next:r=>{this.shops.update(a=>a.map(s=>s.id===e?r.data:s)),this.toast.warn("Shop disabled")}})}enable(e){this.shopSvc.adminEnable(e).subscribe({next:r=>{this.shops.update(a=>a.map(s=>s.id===e?r.data:s)),this.toast.ok("Shop re-enabled \u2705")}})}openCommission(e){this.commissionShop.set(e),this.newCommission=e.commissionPercent||10}saveCommission(){let e=this.commissionShop();e&&this.shopSvc.adminSetCommission(e.id,this.newCommission).subscribe({next:r=>{this.shops.update(a=>a.map(s=>s.id===e.id?r.data:s)),this.commissionShop.set(null),this.toast.ok("Commission updated")}})}static{this.\u0275fac=function(r){return new(r||o)}}static{this.\u0275cmp=$({type:o,selectors:[["app-admin"]],standalone:!0,features:[L],decls:27,vars:4,consts:[["overviewTpl",""],["shopsTpl",""],["bookingsTpl",""],["revenueTpl",""],[2,"display","flex","flex-direction","column","min-height","100vh"],[1,"shell",2,"flex","1"],[1,"sidebar"],[1,"sb-sec"],[1,"sb-item",3,"on"],[1,"sb-footer"],[1,"sb-item",3,"click"],[1,"main"],[1,"mobile-nav"],[1,"mni",3,"on"],[1,"sb-icon"],[1,"sb-badge"],[4,"ngTemplateOutlet"],[1,"mni",3,"click"],[1,"mni-badge"],[1,"mni-icon"],[1,"page","anim-fade-up"],[1,"ph"],[1,"ph-title"],[1,"ph-sub"],[1,"sg"],[1,"sc"],[1,"sc-icon"],[1,"sc-val"],[1,"sc-label"],[1,"sc-chip","chip-g"],[1,"sc-chip","chip-y"],[1,"g2"],[1,"sc-chip","chip-b"],[1,"card",2,"margin-top","14px"],[1,"ch"],[1,"ct"],[1,"btn","btn-ghost-amber","btn-sm",3,"click"],[2,"display","flex","align-items","center","justify-content","space-between","padding","12px 0","border-bottom","1px solid var(--border)"],[2,"display","flex","align-items","center","gap","12px"],[2,"font-size","28px"],[2,"font-weight","700"],[2,"font-size","11px","color","var(--text3)"],[1,"btn","btn-emerald","btn-sm",3,"click"],[1,"ph-row"],[2,"display","flex","gap","6px","margin-bottom","16px","flex-wrap","wrap"],[1,"area-pill",3,"on"],[1,"tw"],[1,"tb"],[1,"mo"],[1,"area-pill",3,"click"],[2,"display","flex","align-items","center","gap","8px"],[2,"font-size","20px"],[1,"tn"],[1,"ts"],[1,"badge"],[3,"status"],[1,"ta"],[2,"display","flex","gap","4px","flex-wrap","wrap"],[1,"btn","btn-emerald","btn-sm"],[1,"btn","btn-crimson","btn-sm"],[1,"btn","btn-ghost","btn-sm",3,"click"],[1,"btn","btn-crimson","btn-sm",3,"click"],[1,"mo",3,"click"],[1,"mb",2,"max-width","360px",3,"click"],[1,"mh"],[1,"mt"],[1,"mx",3,"click"],[1,"mbody"],[2,"font-weight","600","margin-bottom","12px"],[1,"fg"],[1,"fl"],["type","number","min","0","max","30",1,"fi",3,"ngModelChange","ngModel"],[1,"mfoot"],[1,"btn","btn-outline","btn-sm",3,"click"],[1,"btn","btn-amber","btn-sm",3,"click"],[1,"card"],[2,"padding","10px 0","border-bottom","1px solid var(--border)"],[2,"display","flex","justify-content","space-between","margin-bottom","6px"],[2,"font-size","16px"],[2,"margin-left","6px"],[2,"color","var(--text3)","font-size","11px","margin-left","6px"],[2,"font-family","'Unbounded',sans-serif","font-size","16px","font-weight","700","color","var(--amber)"],[1,"pct-bar"],[1,"pct-fill",2,"background","var(--amber)"]],template:function(r,a){if(r&1){let s=h();t(0,"div",4),F(1,"app-topbar"),t(2,"div",5)(3,"aside",6)(4,"div",7),n(5,"Admin Panel"),i(),f(6,de,5,5,"button",8,re),t(8,"div",9)(9,"button",10),x("click",function(){return c(s),_(a.auth.logout())}),n(10,"\u{1F6AA} Logout"),i()()(),t(11,"main",11),v(12,ce,1,1,"ng-container")(13,xe,1,1,"ng-container")(14,ve,1,1,"ng-container")(15,he,1,1,"ng-container"),i()(),t(16,"nav",12),f(17,Se,5,5,"button",13,re),i()(),v(19,we,60,16,"ng-template",null,0,y)(21,De,35,2,"ng-template",null,1,y)(23,Pe,30,1,"ng-template",null,2,y)(25,Ne,46,13,"ng-template",null,3,y)}r&2&&(l(6),g(a.nav),l(6),b(12,a.tab()==="overview"?12:-1),l(),b(13,a.tab()==="shops"?13:-1),l(),b(14,a.tab()==="bookings"?14:-1),l(),b(15,a.tab()==="revenue"?15:-1),l(2),g(a.nav))},dependencies:[H,U,q,te,K,Y,Q,ee,Z,X,oe,ae],encapsulation:2})}}return o})();export{Qe as AdminComponent};
